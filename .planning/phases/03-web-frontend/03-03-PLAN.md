---
phase: 03-web-frontend
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/app/tools/[slug]/page.tsx
  - src/app/not-found.tsx
autonomous: true

must_haves:
  truths:
    - "Each listing has a unique URL at /tools/[slug] that renders all structured metadata"
    - "Listing detail page shows name, tagline, full description, category, tags, source URL, docs URL, license, runtime, chain support, stars, downloads, MCP/ACP compatibility"
    - "SEO metadata (title, description, OpenGraph) is generated dynamically from listing data"
    - "Visiting a non-existent slug shows a proper 404 page, not an error"
    - "Source URL and docs URL are rendered as clickable external links"
  artifacts:
    - path: "src/app/tools/[slug]/page.tsx"
      provides: "Listing detail page with dynamic metadata"
      exports: ["generateMetadata", "default"]
      contains: "getListingBySlug"
    - path: "src/app/not-found.tsx"
      provides: "Custom 404 page"
      contains: "not found"
  key_links:
    - from: "src/app/tools/[slug]/page.tsx"
      to: "src/services/catalog.ts"
      via: "import getListingBySlug"
      pattern: "import.*getListingBySlug.*from.*services/catalog"
    - from: "src/app/tools/[slug]/page.tsx"
      to: "next/navigation"
      via: "notFound() for missing slugs"
      pattern: "notFound\\(\\)"
    - from: "src/app/tools/[slug]/page.tsx"
      to: "src/lib/categories.ts"
      via: "CATEGORY_LABELS for display"
      pattern: "CATEGORY_LABELS"
---

<objective>
Build the listing detail page at `/tools/[slug]` with full structured metadata display and dynamic SEO tags, plus a custom 404 page.

Purpose: Each tool in the catalog gets a unique, shareable URL that presents all structured data (metadata, metrics, links) in a human-readable layout. Dynamic SEO metadata ensures shared links have rich previews on social platforms. This is the core value page — where a developer decides "this tool is worth checking out."

Output: Working detail page at `/tools/[slug]` with all listing metadata displayed, dynamic OG tags, and proper 404 handling.
</objective>

<execution_context>
@/Users/clawdioversace/.claude/get-shit-done/workflows/execute-plan.md
@/Users/clawdioversace/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-web-frontend/03-RESEARCH.md
@.planning/phases/03-web-frontend/03-01-SUMMARY.md

# Service layer and schema
@src/services/catalog.ts
@src/lib/categories.ts
@src/db/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Listing detail page with dynamic SEO metadata</name>
  <files>
    src/app/tools/[slug]/page.tsx
  </files>
  <action>
Create `src/app/tools/[slug]/page.tsx` as an async Server Component with two exports:

**1. `generateMetadata` function:**

```typescript
export async function generateMetadata({
  params,
}: {
  params: Promise<{ slug: string }>
}): Promise<Metadata> {
  const { slug } = await params
  const listing = await getListingBySlug(slug)
  if (!listing) return { title: 'Tool Not Found | AI Bazaar' }
  return {
    title: `${listing.name} | AI Bazaar`,
    description: listing.tagline,
    openGraph: {
      title: `${listing.name} - ${CATEGORY_LABELS[listing.category as Category]}`,
      description: listing.tagline,
      url: `/tools/${slug}`,
      siteName: 'AI Bazaar',
      type: 'website',
    },
  }
}
```

- Import `Metadata` from 'next', `getListingBySlug` from '@/services/catalog', `CATEGORY_LABELS` and `Category` from '@/lib/categories'
- CRITICAL: `params` is a Promise in Next.js 15+ — must `await params`

**2. Default export page component:**

```typescript
export default async function ListingPage({
  params,
}: {
  params: Promise<{ slug: string }>
}) {
  const { slug } = await params
  const listing = await getListingBySlug(slug)
  if (!listing) notFound()
  // Render detail layout
}
```

**3. Detail layout structure (render inside the page):**

Use a two-column layout on desktop (main content + sidebar), single column on mobile.

**Main content (left/top):**
- **Name** as h1
- **Tagline** as subtitle text (muted color)
- **Category badge** using CATEGORY_LABELS (colored badge matching homepage style)
- **Description** — full text. Render as paragraphs (split on double newline). The description field may contain basic text, not markdown for now.
- **Tags** — parse JSON string, render as pill badges (same style as ListingCard but all tags, not just first 3)

**Sidebar (right/bottom on mobile):**
- **Metrics card:**
  - Stars: number with star icon (format with commas for 1000+, e.g., "1,234")
  - Downloads: number with download icon (format with commas, show "N/A" if 0 or null)
- **Links card:**
  - Source code: external link to sourceUrl (render with external link icon, opens in new tab)
  - Documentation: external link to docsUrl if present (same styling)
- **Details card:**
  - License: licenseType value or "Not specified"
  - Runtime: runtime value or "Not specified"
  - Chain support: parse chainSupport JSON array, render as comma-separated list or "None"
  - MCP compatible: Yes/No badge (green for yes)
  - ACP compatible: Yes/No badge
- **Metadata card:**
  - Last verified: format lastVerifiedAt as relative time ("2 days ago") or "Never"
  - Added: format createdAt as date string
  - Updated: format updatedAt as date string

**4. Back navigation:**
- "Back to Browse" link at top of page → `/tools`
- Use `Link` from 'next/link'

**5. Mobile responsive:**
- Single column on mobile (main then sidebar below)
- Two columns on lg+ (grid grid-cols-1 lg:grid-cols-3, main spans 2)
- All text sizes responsive (use Tailwind responsive prefixes)
- External links have adequate touch targets (min 44px height on mobile)
  </action>
  <verify>
- `bun run build` completes without errors
- Visit a known slug URL (pick one from the database) — page renders all metadata
- Page source contains correct OG tags (title, description)
- Stars/downloads show formatted numbers
- External links open in new tab (target="_blank" rel="noopener noreferrer")
- Mobile viewport shows single-column layout
  </verify>
  <done>
Listing detail page at `/tools/[slug]` renders all structured metadata (name, tagline, description, category, tags, links, metrics, compatibility) with dynamic SEO metadata for social sharing. Two-column desktop layout, single-column mobile.
  </done>
</task>

<task type="auto">
  <name>Task 2: Custom 404 page and edge case handling</name>
  <files>
    src/app/not-found.tsx
  </files>
  <action>
**1. Create `src/app/not-found.tsx`:**

Custom 404 page for the entire app (not just /tools/[slug]):

- Server Component (no 'use client')
- Display: "Page Not Found" heading, friendly message ("The tool you're looking for doesn't exist or may have been removed."), "Browse All Tools" link to /tools, "Go Home" link to /
- Style consistently with the rest of the site (same fonts, colors, layout within max-w-7xl container)
- Center content vertically and horizontally
- Use `Link` from 'next/link' for navigation links

**2. Verify notFound() integration:**

The listing detail page (Task 1) calls `notFound()` when `getListingBySlug` returns undefined. This automatically renders the not-found.tsx page. Verify this works by:
- The page should return a 404 HTTP status code
- The custom not-found page should render (not the default Next.js 404)

**3. Edge cases in detail page:**

Ensure the listing detail page handles these gracefully:
- Tags is empty array (JSON "[]") — don't render empty tags section
- chainSupport is null — don't render chain section
- docsUrl is null — don't render docs link
- downloads is 0 — show "0" not "N/A" (downloads of 0 is valid data)
- stars is 0 — show "0"
- lastVerifiedAt is null — show "Never verified"
- description is very long — don't truncate on detail page (it's the full view)
  </action>
  <verify>
- `bun run build` completes without errors
- Visiting `/tools/nonexistent-slug-12345` shows custom 404 page with "Browse All Tools" link
- Visiting `/completely-random-path` also shows custom 404 page
- Detail page handles null docsUrl (no broken link rendered)
- Detail page handles empty tags (no empty section rendered)
  </verify>
  <done>
Custom 404 page renders for any not-found URL with navigation back to browse/home. Listing detail page handles all null/empty edge cases gracefully without broken UI.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` passes with no type errors
2. Visit `/tools/{known-slug}` — full detail page renders with all metadata
3. View page source — OG tags present with listing name and tagline
4. Visit `/tools/this-does-not-exist` — custom 404 page renders
5. External links (sourceUrl, docsUrl) open in new tab
6. Mobile viewport — single column layout, no horizontal scroll
7. Desktop viewport — two-column layout (content + sidebar)
8. Stars/downloads formatted with commas for large numbers
9. Category badge matches the homepage ListingCard style
10. "Back to Browse" link navigates to /tools
</verification>

<success_criteria>
- Every listing in the database is accessible at /tools/[slug] with unique URL
- SEO metadata (title, description, OpenGraph) is dynamically generated per listing
- All 22 schema fields are displayed where applicable (null fields hidden gracefully)
- Non-existent slugs return 404 with custom error page
- Page is mobile-responsive with no horizontal scrolling
</success_criteria>

<output>
After completion, create `.planning/phases/03-web-frontend/03-03-SUMMARY.md`
</output>
