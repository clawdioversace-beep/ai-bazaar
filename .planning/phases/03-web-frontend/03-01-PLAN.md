---
phase: 03-web-frontend
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/app/globals.css
  - src/components/listing-card.tsx
  - src/components/category-nav.tsx
autonomous: true

must_haves:
  truths:
    - "Visitor lands on homepage and sees featured listings (top 6 by stars) above the fold"
    - "Visitor sees 'New this week' section showing listings created in the last 7 days"
    - "Visitor sees category navigation with counts and can click to navigate to /tools?category=X"
    - "Root layout has AI Bazaar branding, navigation header, and proper metadata"
  artifacts:
    - path: "src/app/layout.tsx"
      provides: "Root layout with header, nav, footer, AI Bazaar metadata"
      contains: "AI Bazaar"
    - path: "src/app/page.tsx"
      provides: "Homepage with featured listings and new-this-week"
      contains: "searchCatalog\\|browseByCategory\\|getAllListings"
    - path: "src/components/listing-card.tsx"
      provides: "Reusable listing card component"
      exports: ["ListingCard"]
    - path: "src/components/category-nav.tsx"
      provides: "Category navigation with counts"
      exports: ["CategoryNav"]
  key_links:
    - from: "src/app/page.tsx"
      to: "src/services/search.ts"
      via: "direct import in Server Component"
      pattern: "import.*from.*services/search"
    - from: "src/app/page.tsx"
      to: "src/components/listing-card.tsx"
      via: "component import"
      pattern: "import.*ListingCard"
    - from: "src/components/category-nav.tsx"
      to: "/tools?category="
      via: "Link href"
      pattern: "href.*tools\\?category"
---

<objective>
Build the root layout, shared UI components (ListingCard, CategoryNav), and homepage with featured listings and "new this week" section.

Purpose: Establish the visual foundation and homepage experience so visitors immediately see value (featured tools, recent additions, category navigation) without friction. All subsequent pages (browse, detail) reuse these shared components.

Output: Working homepage at `/` with real data from the catalog, reusable ListingCard and CategoryNav components, branded root layout.
</objective>

<execution_context>
@/Users/clawdioversace/.claude/get-shit-done/workflows/execute-plan.md
@/Users/clawdioversace/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-web-frontend/03-RESEARCH.md

# Existing service layer
@src/services/search.ts
@src/services/catalog.ts
@src/lib/categories.ts
@src/db/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Root layout + shared components (ListingCard, CategoryNav)</name>
  <files>
    src/app/layout.tsx
    src/app/globals.css
    src/components/listing-card.tsx
    src/components/category-nav.tsx
  </files>
  <action>
**1. Update `src/app/layout.tsx`:**
- Replace boilerplate metadata: title "AI Bazaar - Discover AI, Agent & Web3 Tools", description "Permissionless discovery platform for AI, agent, and Web3 tools. Find MCP servers, AI agents, DeFi tools, and more."
- Add a responsive header with "AI Bazaar" branding (text logo, no image needed), nav links: Home (/), Browse (/tools)
- Add a minimal footer with "AI Bazaar" and current year
- Keep Geist Sans/Mono fonts (already configured)
- Use Server Component (no 'use client') — header/footer are static
- Wrap children in a `<main>` with max-width container (max-w-7xl mx-auto)

**2. Update `src/app/globals.css`:**
- Keep existing Tailwind import and theme variables
- Add custom utility classes if needed for consistent card shadows, hover states
- Ensure dark mode variables are reasonable (keep existing dark mode setup)

**3. Create `src/components/listing-card.tsx`:**
- Server Component (no 'use client') — purely presentational
- Props: listing object (Listing type from db/schema.ts)
- Display: name (as link to `/tools/${listing.slug}`), tagline (truncated to 2 lines), category badge (using CATEGORY_LABELS), stars count with star icon, runtime badge if present
- Parse tags from JSON string and show first 3 as small pills
- Parse chainSupport from JSON string and show chain badges if present
- Use Tailwind for styling: card with border, rounded corners, hover shadow, padding
- Mobile: full width. Desktop: works in grid context (card doesn't set its own width)
- Import Link from 'next/link' for client-side navigation to detail pages

**4. Create `src/components/category-nav.tsx`:**
- Server Component (no 'use client') — just renders links
- Props: categories array of { category: string, count: number, label: string }
- Render as horizontal scrollable row on mobile, wrapping grid on desktop
- Each category is a Link to `/tools?category=${category}` showing label + count badge
- Use CATEGORY_LABELS from src/lib/categories.ts for display names
- Active state will be handled by the browse page (this component just renders)
  </action>
  <verify>
- `bun run build` completes without errors (type checks pass)
- `src/components/listing-card.tsx` exports ListingCard
- `src/components/category-nav.tsx` exports CategoryNav
- `src/app/layout.tsx` contains "AI Bazaar" in metadata title
  </verify>
  <done>
Root layout renders with header (AI Bazaar branding + nav) and footer. ListingCard component renders a listing with name, tagline, category, stars, and tags. CategoryNav renders category links with counts pointing to /tools?category=X.
  </done>
</task>

<task type="auto">
  <name>Task 2: Homepage with featured listings and new-this-week</name>
  <files>
    src/app/page.tsx
  </files>
  <action>
**Replace `src/app/page.tsx` entirely** with an async Server Component:

**1. Data fetching (top of component, no useEffect):**
- Import `countByCategory` from `@/services/search`
- Import `getAllListings` from `@/services/catalog` (or use a raw query — see below)
- Featured listings: Query top 6 by stars. Use `db.query.listings.findMany({ limit: 6, orderBy: desc(stars), where: eq(deadLink, false) })` via a new helper OR use `getAllListings` sorted differently. Simplest approach: add a direct Drizzle query in the page since SearchService doesn't have a "top by stars" function. Import `db` from `@/db/client`, `listings` from `@/db/schema`, and use `db.query.listings.findMany({ where: (l, { eq }) => eq(l.deadLink, false), orderBy: (l, { desc }) => [desc(l.stars)], limit: 6 })`.
- New this week: Query listings where `createdAt >= new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)`, ordered by createdAt DESC, limit 12. Use `db.query.listings.findMany({ where: (l, { gte, eq, and }) => and(eq(l.deadLink, false), gte(l.createdAt, sevenDaysAgo)), orderBy: (l, { desc }) => [desc(l.createdAt)], limit: 12 })`.
- Category counts: Call `countByCategory()` from SearchService.

**IMPORTANT DECISION:** Rather than importing `db` directly in a page component (which violates the "service-only DB access" pattern from Phase 1), add two new functions to `src/services/search.ts`:
- `getFeaturedListings(limit = 6)` — returns top N by stars, deadLink=false
- `getNewThisWeek(limit = 12)` — returns listings where createdAt >= 7 days ago, deadLink=false, ordered by createdAt DESC

Then import those in page.tsx.

**2. Hero section:**
- Brief hero text: "Discover AI, Agent & Web3 Tools" headline, one-line subtitle about the catalog size (can hardcode "3,000+" or fetch a count)
- Search bar placeholder (non-functional link that navigates to /tools?q= — just a styled link or form that redirects, NOT a client-side search implementation)
- Keep hero compact — featured listings should be visible without scrolling on most screens

**3. Featured listings section:**
- Heading: "Featured Tools" or "Top Tools"
- Render 6 ListingCard components in a responsive grid: 1 col mobile, 2 cols tablet, 3 cols desktop
- Use the ListingCard component from Task 1

**4. New this week section:**
- Heading: "New This Week"
- Render up to 12 ListingCard components in same responsive grid
- If no new listings this week, show a friendly message ("Check back soon!")

**5. Category navigation section:**
- Heading: "Browse by Category"
- Render CategoryNav component with data from countByCategory()
- Map category counts to include CATEGORY_LABELS for display

**6. Page metadata:**
- Export const metadata with title "AI Bazaar - Discover AI, Agent & Web3 Tools"
  </action>
  <verify>
- `bun run build` completes without errors
- `bun run dev` shows homepage with featured listings, new this week, and category nav
- Featured section shows 6 cards sorted by stars
- Category nav links point to /tools?category=X
- No 'use client' directive in page.tsx
  </verify>
  <done>
Homepage at `/` renders featured listings (top 6 by stars), new-this-week section (last 7 days), and category navigation with counts. All data fetched server-side. No client-side JavaScript needed for initial render.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` passes with no type errors
2. `bun run dev` — homepage loads at localhost:3000 with real catalog data
3. Featured section shows 6 listing cards sorted by stars descending
4. New this week section shows recently added listings (or empty state message)
5. Category nav shows all 6 categories with counts, links to /tools?category=X
6. Header shows "AI Bazaar" branding with Home and Browse links
7. No 'use client' directive on any file created in this plan (all Server Components)
</verification>

<success_criteria>
- Homepage renders real catalog data (featured + new this week) without any client-side JavaScript for data fetching
- ListingCard and CategoryNav components are reusable by browse page (Plan 02)
- Root layout provides consistent header/footer across all pages
- All links use next/link for client-side navigation
</success_criteria>

<output>
After completion, create `.planning/phases/03-web-frontend/03-01-SUMMARY.md`
</output>
